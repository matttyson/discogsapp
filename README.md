# discogsapp

This is currently an experimental project to play with C++17 and REST.  It's working in a basic state, but the API is not stable and few endpoints are implemented.

It's envisioned to be a cross platform C++ library for talking to the [discogs](http://www.discogs.com/) REST [API](https://www.discogs.com/developers/), along with a command line driver and maybe down the track a GUI app.

## libdiscogs

This is a C++ static library to talk to the [REST API](https://www.discogs.com/developers/)

## discogscli

This is a command line driver that makes use of the libdiscogs library

## libplatform

A cross platform portability library to abstract away platform specific details.

## liboauth1

This is a wrapper around the cpprestsdk to manage authentication with discogs via the OAuth1.0a protocol.

## Building

CMake is used to to the build.  Instructions for Windows and Linux are below.

### Windows:

* Visual Studio 2017
* [cpprestsdk](https://github.com/Microsoft/cpprestsdk)
* [rapidjson](https://github.com/Tencent/rapidjson)
* [zlib](https://zlib.net)
* patched [cxxops](https://github.com/matttyson/cxxopts/tree/wstring) library, wstring branch.

cpprestsdk can be built on Windows with CMake. We don't need websockets for this so we can skip having to build boost and openssl by excluding websockets from the build.  The following cmake args can be used to build cpprestsdk:

* `CPPRESTSDK_EXCLUDE_WEBSOCKETS=ON`
* `BUILD_SHARED_LIBS=OFF` (for static build)
* `ZLIB_LIBRARY=C:\path\to\zlib.lib`
* `ZLIB_INCLUDE_DIR=C:\path\to\include`

The app itself will need the following args passed to cmake when building on windows

* `CPPRESTSDK_LIBRARY=C:\path\to\cpprest_2_10d.lib`
* `CPPRESTSDK_INCLUDE_DIR=C:\path\to\include\cpprest`
* `ZLIB_LIBRARY=C:\path\to\zlib.lib`
* `CXXOPTS_INCLUDE_DIR=C:\path\to\cxxopts\include`
* `RAPIDJSON_INCLUDE_DIR=C:\path\to\rapidjson\include`

### Linux

rapidjson and the cpprestsdk are available in most distros package managers.  Installing the devel packages is normally sufficcent.  cxxopts is not packaged in a distro and must be downloaded manually.

* GCC 7 or later.
* [rapidjson](https://github.com/Tencent/rapidjson)
* [cpprestsdk](https://github.com/Microsoft/cpprestsdk)
* [cxxopts](https://github.com/jarro2783/cxxopts)

When building on linux you must provide the location of the cxxopts headers

* `CXXOPTS_INCLUDE_DIR=/path/to/cxxopts/include`

## What's Working

Currently implement is the following

* OAuth authentication.
* Wantlist add/remove/update operations.
* Release information.

## Usage

For OAuth authentication to work you will need a consumer key and secret which can be created in the [developer settings page](https://www.discogs.com/settings/developers)

Add the key and secret to oauth1_data.cpp in discogscli.

Once the executable has been compiled, run with --help for usage instructions.

## TODO

* Implement more endpoints.
* Clean up compile warnings in autogenerated code.
* Add more autotests.
